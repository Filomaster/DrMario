$gs: 5vh;
$board-width: 8 * $gs;
$screen-width: 134vh;

// All colors in the foreground
$gray: #837e85;
$blue: #78a0db;
$yellow: #f4e377;
$red: #9e454c;

body {
  color: #fff;
  background-color: black;
  margin: 0;
  padding: 0;
}

// Sooo... these are all dynamically changed variable, to provide feel of original games, regardless emulation mode
:root {
  --width: 134vh;
  --height: 100vh;
  --jar-width: 12;
  --jar-height: 0;
  --left-decoration-width: 0;
  --scoreboard-height: 0;
  --info-width: 0;
  --glass-width: 0;
  --glass-height: 0;
  --tiles-width: 40;
  --tiles-height: 24;
  --dr-bcg-size: 0;
  --dr-bcg-offset: 0;
  --board-offset-x: 0;
  --board-offset-y: 0;
  --offset-x: 16vh;
  --offset-y: 6vh;
  --tile-size: 10px;
  --bcg-tile-size: 10px;
  // Background colors
  --background-tile-a: #d6d6d6;
  --background-tile-b: transparent;

  // Background images
  --jar-img: 0;
  --jar-mask: 0;
  --glass-img: 0;
  --info-img: 0;
  --dr-bcg-img: 0;
  --scoreboard-img: 0;
  // Sprites
  // > Pills
  //   > Yellow
  --yl-left: 0;
  --yl-right: 0;
  --yl-up: 0;
  --yl-down: 0;
  --yl-dot: 0;
  --yl-o: 0;
  //   > Red
  --rd-left: 0;
  --rd-right: 0;
  --rd-up: 0;
  --rd-down: 0;
  --rd-dot: 0;
  --rd-o: 0;
  //   > Blue
  --bl-left: 0;
  --bl-right: 0;
  --bl-up: 0;
  --bl-down: 0;
  --bl-dot: 0;
  --bl-o: 0;
  // > Viruses
  //   > Yellow
  --yl-x: 0;
  --yl-virus: 0;
  //   > Red
  --rd-x: 0;
  --rd-virus: 0;
  //   > Blue
  --bl-x: 0;
  --bl-virus: 0;
}

.background {
  width: var(--width);
  height: 100vh;
  margin: auto;
  position: relative;
}
.background-fill {
  position: absolute;
  width: var(--width);
  display: grid;
  grid-template-columns: repeat(var(--tiles-width), var(--bcg-tile-size));
  grid-auto-rows: minmax(var(--bcg-tile-size), auto);
}

.info {
  position: absolute;
  width: var(--info-width);
  height: var(--left-decoration-width);
  right: var(--tile-size);
  bottom: 0;
  background-position: center;
  background-image: var(--info-img);
  background-repeat: no-repeat;
  background-size: var(--info-width) var(--left-decoration-width);
  image-rendering: pixelated;
}
.dr-bcg {
  position: absolute;
  width: var(--dr-bcg-size);
  height: var(--dr-bcg-size);
  right: var(--dr-bcg-offset);
  top: var(--dr-bcg-offset);
  background-image: var(--dr-bcg-img);
  background-repeat: no-repeat;
  background-size: var(--dr-bcg-size) var(--dr-bcg-size);
  image-rendering: pixelated;
}

.scoreboard {
  position: absolute;
  width: var(--left-decoration-width);
  height: var(--scoreboard-height);
  left: var(--tile-size);
  top: var(--tile-size);
  background-position: center;
  background-image: var(--scoreboard-img);
  background-repeat: no-repeat;
  background-size: var(--left-decoration-width) var(--scoreboard-height);
  image-rendering: pixelated;
}

.glass {
  position: absolute;
  width: var(--left-decoration-width);
  height: var(--glass-height);
  left: var(--tile-size);
  bottom: 0;
  background-position: center;
  background-image: var(--glass-img);
  background-repeat: no-repeat;
  background-size: var(--left-decoration-width) var(--glass-height);
  image-rendering: pixelated;
}

.jar {
  position: absolute;
  bottom: var(--offset-y);
  left: var(--offset-x);
  width: var(--jar-width);
  height: var(--jar-height);
  background-image: var(--jar-img);
  background-repeat: no-repeat;
  background-size: var(--jar-width) var(--jar-height);
  image-rendering: pixelated;
}
.jar-mask {
  position: absolute;
  bottom: var(--offset-y);
  left: var(--offset-x);
  width: var(--jar-width);
  height: var(--jar-height);
  background-color: var(--background-tile-a);
  mask: var(--jar-mask);
  mask-size: var(--jar-width) var(--jar-height);
  image-rendering: pixelated;
}

.grid-container {
  position: absolute;
  left: var(--board-offset-x);
  bottom: var(--board-offset-y);
  display: grid;

  grid-template-columns: repeat(8, var(--tile-size));
  grid-template-rows: repeat(16, var(--tile-size));
}

.crt::before {
  content: " ";
  display: block;
  width: var(--width);
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
    linear-gradient(90deg, rgba(255, 0, 0, 0.05), rgba(0, 255, 0, 0.05), rgba(0, 0, 255, 0.05));
  z-index: 2;
  background-size: 100% 2px, 3px 100%;
  pointer-events: none;
}

.crt::after {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background: rgba(18, 16, 16, 0.1);
  opacity: 0;
  z-index: 2;
  pointer-events: none;
  animation: flicker 0.15s infinite;
}

.vignette {
  position: absolute;
  height: 100vh;
  width: var(--width);
  margin: auto;
  background: radial-gradient(transparent 85%, #000000bb),
    linear-gradient(90deg, #000000bb, transparent 15%, transparent 85%, #000000bb),
    linear-gradient(#000000bb, transparent 5%, transparent 95%, #000000bb);
  background-blend-mode: multiply;
  z-index: 4;
}

// prettier-ignore
.pixel-perfect{
  background-position: center;
  background-size: 100%;
  image-rendering: pixelated;
  &.virus{
    &.yellow { 
      background-image: var(--yl-virus); 
      &.clear{background-image: var(--yl-x)}
    }
    &.red { 
      background-image: var(--rd-virus);
      &.clear{background-image: var(--rd-x)}
    }
    &.blue { 
      background-image: var(--bl-virus); 
      &.clear{background-image: var(--bl-x)}
    }
  }
  &.pill{
    &.yellow {
      &.single { background-image: var(--yl-dot) }
      &.up { background-image: var(--yl-up)  }
      &.down { background-image: var(--yl-down) }
      &.left { background-image: var(--yl-left) }
      &.right { background-image: var(--yl-right) }
      &.clear { background-image: var(--yl-o) }
    }
    &.red { 
      &.single { background-image: var(--rd-dot) }
      &.up { background-image: var(--rd-up)  }
      &.down { background-image: var(--rd-down) }
      &.left { background-image: var(--rd-left) }
      &.right { background-image: var(--rd-right) }
      &.clear { background-image: var(--rd-o) }
    }
    &.blue { 
      &.single { background-image: var(--bl-dot) }
      &.up { background-image: var(--bl-up)  }
      &.down { background-image: var(--bl-down) }
      &.left { background-image: var(--bl-left) }
      &.right { background-image: var(--bl-right) }
      &.clear { background-image: var(--bl-o) }
    }
  }
}

.error {
  background-color: white;
}
// Flicker keyframes are taken from internet to emulate crt look
// prettier-ignore
@keyframes flicker {
  0% { opacity: 0.27861; }
  5% { opacity: 0.34769; }
  10% { opacity: 0.23604; }
  15% { opacity: 0.90626; }
  20% { opacity: 0.18128; }
  25% { opacity: 0.83891; }
  30% { opacity: 0.65583; }
  35% { opacity: 0.67807; }
  40% { opacity: 0.26559; }
  45% { opacity: 0.84693; }
  50% { opacity: 0.96019; }
  55% { opacity: 0.08594; }
  60% { opacity: 0.20313; }
  65% { opacity: 0.71988; }
  70% { opacity: 0.53455; }
  75% { opacity: 0.37288; }
  80% { opacity: 0.71428; }
  85% { opacity: 0.70419; }
  90% { opacity: 0.7003; }
  95% { opacity: 0.36108; }
  100% { opacity: 0.24387; }
}
